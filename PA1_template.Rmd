---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

I'm high-maintenance...
```{r}
require(dplyr)
require(ggplot2)
require(lubridate)
```

The data is read in and dates changed to lubridates.

```{r}
unzip("activity.zip", exdir="data")
activity_data <- read.csv("data/activity.csv")

activity_data$date <- ymd(activity_data$date)
```

## What is mean total number of steps taken per day?

To answer this question, we need to group the data frame by day, sum the total steps per day.

```{r}
steps_per_day <- activity_data %>%
  tbl_df %>%
  mutate(steps = as.numeric(as.character(steps))) %>%
  group_by(date) %>%
  mutate(total_steps = sum(steps))
```

We then plot total steps per day:

```{r}
hist(steps_per_day$total_steps, breaks=7,
     main = "Total Steps per Day", 
     xlab = "total steps/day")
```

It looks normally distributed, with between 10,000 and 15,000 being the most
most common count of total steps in a day.

The mean and median of the total steps per day can now be calculated.

```{r}
mean_total_steps <- mean(steps_per_day$total_steps, na.rm=TRUE)
median_total_steps <- median(steps_per_day$total_steps, na.rm=TRUE)
```

The mean of total steps per day is `r mean_total_steps`.
The median of total steps per day is `r median_total_steps`. 

These are pretty close - another indication that total steps per day
are normally distributed. Initially I would expect our participant to work
a job that doesn't require much differentially distributed travel (e.g.
a 9-5). 

## What is the average daily activity pattern?

The average daily activity pattern is more specifically obtained by
taking the mean of each interval period over all the days. We can take a
look at the plot of mean steps as a function of each interval period.

```{r}
steps_per_interval <- activity_data %>%
  tbl_df %>%
  group_by(interval) %>%
  summarize(steps2 = mean(steps, na.rm=TRUE))

par(mfrow =c(1,1))
with(steps_per_interval, plot(interval, steps2, type="l", col = "blue"))
```


And which interval contains the largest steps? We can compute this by
indexing the max steps and using this index to obtain the interval.

```{r}
largest_interval <- which.max(steps_per_interval$steps2)
int <- steps_per_interval$interval[largest_interval]
int2 <- int+5
```

The interval containing the largest steps is `r int` - `r int2`.

## Imputing missing values

Many of the days have missing values. Possibly, some of the days are completely
missing values, while some of the days may only have a few missing.

One strategy for filling in these values would be to either:
  1) Take the mean for the day and use this mean to fill in that days'
     missing values.
  1) If no values exist for a certain day, take the mean of all steps 
     in the data set and use this value for that day.

I first create a data frame only containing the mean values for each day:

```{r}

```




## Are there differences in activity patterns between weekdays and weekends?
